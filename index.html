<!doctype html>
<html>
<head>
 <meta charset=utf-8>
 <meta name=viewport content="width=device-width,minimum-scale=1.0,initial-scale=1,maximum-scale=1.0,user-scalable=no">
 <title>HTML is a Programming Language</title>
 <style>body{padding:2em;font-family:monospace;background-color:#f0f0f0;color:#222222}</style>
</head>
<body>
  <p>Read the Source or read the description here: <a href="https://github.com/marianoguerra/hiapl">github.com/marianoguerra/hiapl</a></p>

  <template id=overview>
    <div>
      <let s=hello n=4 b=true v=$s>
        <p>String: <v $s></v></p>
        <p>Number: <v $n></v></p>
        <p>Boolean: <v $b></v></p>
        <p>Variable: <v $v></v></p>

        <nb>
          String: <v $s></v>
          Number: <v $n></v>
          Boolean: <v $b></v>
          Variable: <v $v></v>
        </nb>

        <do push $n></do>
        <do push 3></do>
        <do rem></do>
        <do push 0></do>
        <do eq></do>
        <do set isMod3></do>
        <nb>i = <v $n></v> n % 3 == 0? <v $isMod3></v></nb>

        <do range 1 $n></do>
        <do set nums></do>
        <for i in $nums>
          <p>i: <v $i></v></p>
        </for>
      </let>
    </div>
  </template>

  <template id=fizzbuzz1>
    <div>
     <do range 1 15></do>
     <do set nums></do>
     <for i in $nums>
      <do push $i></do>
      <do push 3></do>
      <do rem></do>
      <do push 0></do>
      <do eq></do>
      <do set isMod3></do>
      <nb>i = <v $i></v> i % 3 == 0? <v $isMod3></v></nb>

      <do push $i></do>
      <do push 4></do>
      <do rem></do>
      <do push 0></do>
      <do eq></do>
      <do set isMod4></do>
      <nb>i = <v $i></v> i % 4 == 0? <v $isMod4></v></nb>

      <do push $isMod3></do>
      <do push $isMod4></do>
      <do and></do>
      <do set isMod3AndMod4></do>
      <nb>i = <v $i></v> i % 3 == 0 and i % 4 == 0? <v $isMod3AndMod4></v></nb>

      <cond>
          <if $isMod3AndMod4><p>FizzBuzz</p></if>

          <if $isMod3><p>Fizz</p></if>

          <if $isMod4><p>Buzz</p></if>

          <else><p><v $i></v></p></else>
      </cond>
     </for>
    </div>
  </template>

  <template id=fizzbuzz2>
    <div>
      <defn calc-is-mod i n>
        <do push $i></do>
        <do push $n></do>
        <do rem></do>
        <do push 0></do>
        <do eq></do>
      </defn>

      <defn fizzbuzz from to>
        <do range $from $to></do>
        <do set nums></do>
        <for i in $nums>
          <do calc-is-mod $i 3></do>
          <do set isMod3></do>
          <nb>i = <v $i></v> i % 3 == 0? <v $isMod3></v></nb>

          <do calc-is-mod $i 4></do>
          <do set isMod4></do>
          <nb>i = <v $i></v> i % 4 == 0? <v $isMod4></v></nb>

          <do push $isMod3></do>
          <do push $isMod4></do>
          <do and></do>
          <do set isMod3AndMod4></do>
          <nb>i = <v $i></v> i % 3 == 0 and i % 4 == 0? <v $isMod3AndMod4></v></nb>

          <cond>
            <if $isMod3AndMod4><p>FizzBuzz</p></if>

            <if $isMod3><p>Fizz</p></if>

            <if $isMod4><p>Buzz</p></if>

            <else><p><v $i></v></p></else>
          </cond>
        </for>
      </defn>

      <do fizzbuzz 1 21></do>
      <do pop></do>
    </div>
  </template>

  <template id=counterapp>
    <div>
      <defn on-dec-click e>
       <do on-btn-click e dec></do>
      </defn>

      <defn on-inc-click e>
       <do on-btn-click e inc></do>
      </defn>

      <defn on-btn-click e op>
        <do query-selector-id counter></do>
        <do set input></do>

        <do get-attribute $input value></do>
        <do set cur-count-raw></do>

        <do parse-int $cur-count-raw></do>
        <!-- higher order functions :P -->
        <do $op></do>
        <do set new-count></do>

        <do set-attribute $input value $new-count></do>
      </defn>

      <do add-event-listener-id dec click on-dec-click></do>
      <do add-event-listener-id inc click on-inc-click></do>
    </div>
  </template>

  <button id=dec>-</button>
  <input type=number readonly id=counter value=0>
  <button id=inc>+</button>

  <div id=counterout></div>

  <div id=overviewout>
    <h2>Overview Output</h2>
  </div>

  <div id=fizzbuzz2out>
    <h2>Fizzbuzz 2 Output</h2>
  </div>

  <script src="js/app.js"></script>
  <script>
    //evalFromTo(document.querySelector('#fizzbuzz1'), document.body);
    //evalFromTo(document.querySelector('#fizzbuzz2'), document.body);
    evalFromTo(document.querySelector('#counterapp'), document.querySelector('#counterout'));
    evalFromTo(document.querySelector('#overview'), document.querySelector('#overviewout'));
    evalFromTo(document.querySelector('#fizzbuzz2'), document.querySelector('#fizzbuzz2out'));
  </script>
</body>
</html>
